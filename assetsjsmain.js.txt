// Simplified Content System - No External APIs Needed
console.log('üß† AI Insights Hub - Loading...');

// Mock data that always works
const mockNewsData = [
    {
        title: "OpenAI Releases GPT-4.5 with Enhanced Reasoning Capabilities",
        source: "OpenAI Blog",
        time: "2 hours ago",
        summary: "The latest iteration shows significant improvements in logical reasoning and mathematical problem-solving, marking a major step forward in AI development.",
        category: "news",
        url: "https://openai.com/blog"
    },
    {
        title: "Google DeepMind Announces Breakthrough in Protein Folding",
        source: "DeepMind",
        time: "4 hours ago", 
        summary: "New AI system can predict protein structures with 99% accuracy, potentially revolutionizing drug discovery and medical research.",
        category: "research",
        url: "https://deepmind.google"
    },
    {
        title: "Microsoft Copilot Enterprise Hits 100 Million Users",
        source: "Microsoft",
        time: "6 hours ago",
        summary: "Enterprise adoption accelerates as companies report 40% productivity gains from AI-assisted coding and document creation.",
        category: "business",
        url: "https://microsoft.com"
    },
    {
        title: "Meta's LLaMA 3 Shows Competitive Performance Against GPT-4",
        source: "Meta AI",
        time: "8 hours ago",
        summary: "Open-source language model demonstrates comparable capabilities in reasoning tasks, challenging proprietary model dominance.",
        category: "opensource",
        url: "https://ai.meta.com"
    },
    {
        title: "Tesla's Full Self-Driving Beta Reaches Version 12.0",
        source: "Tesla",
        time: "10 hours ago",
        summary: "Neural network-based approach shows dramatic improvements in complex urban driving scenarios and edge case handling.",
        category: "autonomous",
        url: "https://tesla.com"
    },
    {
        title: "Anthropic's Constitutional AI Reduces Harmful Outputs by 90%",
        source: "Anthropic",
        time: "12 hours ago",
        summary: "New training methodology creates more helpful, harmless, and honest AI systems through constitutional principles.",
        category: "safety",
        url: "https://anthropic.com"
    },
    {
        title: "NVIDIA H200 GPUs Accelerate AI Training by 300%",
        source: "NVIDIA",
        time: "14 hours ago",
        summary: "Latest generation AI chips with HBM3e memory enable faster training of large language models and computer vision systems.",
        category: "hardware",
        url: "https://nvidia.com"
    },
    {
        title: "GitHub Copilot Workspace Revolutionizes Software Development",
        source: "GitHub",
        time: "16 hours ago",
        summary: "AI-powered development environment can understand requirements, write code, test, and deploy applications autonomously.",
        category: "development",
        url: "https://github.com"
    },
    {
        title: "Stanford HAI Report: AI Investment Reaches $189 Billion",
        source: "Stanford HAI",
        time: "18 hours ago",
        summary: "Annual AI Index reveals massive growth in funding, with enterprise applications driving the majority of investment.",
        category: "investment",
        url: "https://hai.stanford.edu"
    },
    {
        title: "Stability AI Releases SDXL Turbo for Real-Time Image Generation",
        source: "Stability AI",
        time: "20 hours ago",
        summary: "New diffusion model generates high-quality images in real-time, enabling interactive creative applications.",
        category: "generative",
        url: "https://stability.ai"
    }
];

// Function to check authentication
function checkAuth() {
    // For testing, let's assume user is logged in
    // You can change this to false to test the login gate
    const isLoggedIn = localStorage.getItem('userToken') || 'demo-user';
    console.log('Auth check:', isLoggedIn ? 'Logged in' : 'Not logged in');
    return isLoggedIn;
}

// Function to show content gate
function showContentGate() {
    const contentGate = document.getElementById('content-gate');
    const newsGrid = document.getElementById('news-grid');
    
    if (contentGate) {
        contentGate.style.display = 'block';
        console.log('‚úÖ Content gate displayed');
    }
    
    if (newsGrid) {
        newsGrid.style.display = 'none';
    }
}

// Function to load and display news
function loadNews() {
    console.log('üîÑ Loading news...');
    
    const newsGrid = document.getElementById('news-grid');
    const contentGate = document.getElementById('content-gate');
    
    if (!newsGrid) {
        console.error('‚ùå News grid element not found!');
        return;
    }

    // Check if user is authenticated
    const isLoggedIn = checkAuth();
    
    if (!isLoggedIn) {
        showContentGate();
        return;
    }

    // Hide content gate and show news
    if (contentGate) {
        contentGate.style.display = 'none';
    }
    
    newsGrid.style.display = 'grid';
    
    // Render news articles
    const newsHTML = mockNewsData.map((article, index) => `
        <div class="news-item" onclick="window.open('${article.url}', '_blank')">
            <div class="news-content">
                <div class="news-meta">
                    <span class="news-source">${article.source}</span>
                    <span class="news-time">${article.time}</span>
                    <span class="news-rank">#${index + 1}</span>
                </div>
                <h3 class="news-title">${article.title}</h3>
                <p class="news-summary">${article.summary}</p>
                <div class="news-tags">
                    <span class="tag ${article.category}">${article.category}</span>
                    <span class="tag">AI</span>
                    <span class="tag live">LIVE</span>
                </div>
            </div>
        </div>
    `).join('');
    
    newsGrid.innerHTML = newsHTML;
    
    // Update statistics
    updateStats();
    
    console.log('‚úÖ News loaded successfully!', mockNewsData.length, 'articles');
}

// Function to update statistics
function updateStats() {
    const statsElement = document.getElementById('live-stats');
    if (statsElement) {
        statsElement.innerHTML = `
            <div class="stat">
                <span class="stat-number">${mockNewsData.length}</span>
                <span class="stat-label">Live Articles</span>
            </div>
            <div class="stat">
                <span class="stat-number">50+</span>
                <span class="stat-label">AI Sources</span>
            </div>
            <div class="stat">
                <span class="stat-number">1h</span>
                <span class="stat-label">Auto Refresh</span>
            </div>
        `;
        console.log('‚úÖ Stats updated');
    }

    // Update last updated time
    const lastUpdatedElement = document.getElementById('last-updated');
    if (lastUpdatedElement) {
        lastUpdatedElement.textContent = `Last updated: ${new Date().toLocaleTimeString()}`;
        console.log('‚úÖ Last updated time set');
    }
}

// Function to simulate login (for testing)
function simulateLogin() {
    localStorage.setItem('userToken', 'demo-user-' + Date.now());
    localStorage.setItem('userData', JSON.stringify({
        name: 'Demo User',
        email: 'demo@example.com'
    }));
    console.log('‚úÖ Demo login successful');
    loadNews();
    updateAuthButtons();
}

// Function to simulate logout
function simulateLogout() {
    localStorage.removeItem('userToken');
    localStorage.removeItem('userData');
    console.log('‚úÖ Logged out');
    showContentGate();
    updateAuthButtons();
}

// Update authentication buttons
function updateAuthButtons() {
    const isLoggedIn = checkAuth();
    const authButtons = document.getElementById('auth-buttons');
    const userMenu = document.getElementById('user-menu');
    
    if (isLoggedIn) {
        if (authButtons) authButtons.style.display = 'none';
        if (userMenu) userMenu.style.display = 'block';
    } else {
        if (authButtons) authButtons.style.display = 'flex';
        if (userMenu) userMenu.style.display = 'none';
    }
}

// Auto-refresh every 5 minutes for demo
setInterval(loadNews, 300000);

// Initialize when page loads
document.addEventListener('DOMContentLoaded', function() {
    console.log('üöÄ DOM Content Loaded');
    console.log('üìç Current URL:', window.location.href);
    
    // Check if required elements exist
    const newsGrid = document.getElementById('news-grid');
    const contentGate = document.getElementById('content-gate');
    
    console.log('Elements found:', {
        newsGrid: !!newsGrid,
        contentGate: !!contentGate
    });
    
    // Load content
    loadNews();
    updateAuthButtons();
    
    // Add demo login button to console
    console.log('üîß Debug Commands:');
    console.log('- simulateLogin() - Login as demo user');
    console.log('- simulateLogout() - Logout');
    console.log('- loadNews() - Reload news');
});

// Global functions for testing
window.simulateLogin = simulateLogin;
window.simulateLogout = simulateLogout;
window.loadNews = loadNews;

console.log('‚úÖ AI Insights Hub JavaScript loaded successfully!');
